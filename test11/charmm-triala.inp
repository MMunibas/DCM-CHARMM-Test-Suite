* trialanine in waterbox for comparison with DCM routines
*

bomlev -1
prnlev 4 node 0

open unit 30 card read name par/top_all36_prot.rtf
read rtf card unit 30
close unit 30

open unit 31 card read name par/par_all36_prot.prm
read para card flex unit 31
close unit 31

stream par/toppar_water_ions.str

READ SEQUENCE CARD
* Ala tripeptide
*
 3
ALA ALA ALA

GENERATE LIG FIRST NTER LAST CNEU SETUP NOANG NODIHED

READ SEQUENCE CARD
* TIP3P solvent box
* 
 795
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3
TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 TIP3 

GENERATE WAT FIRST NONE LAST NONE SETUP NOANG NODIHED

READ SEQUENCE CARD
* Cl- ion
*
 1
CLA 

GENERATE ION FIRST NONE LAST NONE SETUP NOANG NODIHED

open unit 20 card read name par/equi.crd
read coor card unit 20
close unit 20

! pbc

crystal defi cubic 28.65 28.65 28.65 90. 90. 90.
crystal build nope 0
image byres xcen 0.0 ycen 0.0 zcen 0.0 sele .not. segi pep end
image byseg xcen 0.0 ycen 0.0 zcen 0.0 sele segi pep end

!set nonbonding parameters

nbond nbxmod 5 atom cdie eps 1.0 -
  ewald pmewald kappa 0.32  -
  fftx 32 ffty 32 fftz 32 order 6 -
  cutnb 14.0 cutim 14.0 ctofnb 12.0 ctonnb 10.0 -
  vswitch vatom vdist e14f 1.0

update


! amoeba parameters
xtbd repl mors 141.6662 1.2307 2.1118 sele bynu 11 end sele bynu 12 end
xtbd repl mors 141.6662 1.2307 2.1118 sele bynu 21 end sele bynu 22 end
xtbd repl mors 141.6662 1.2307 2.1118 sele bynu 31 end sele bynu 32 end



!coor stat sele .not. ((segid WAT) .or. (segid CLA)) end
!coor tran xdir -5.0 ydir -12.0 zdir 9.0 sele .not. ((segid WAT) .or. (segid CLA)) end
!coor stat sele .not. ((segid WAT) .or. (segid CLA)) end

!cons fix sele .not. ((segid WAT)) end
shake bonh para tol 1.0e-8

energy

test first toler 0.000o sele bynu 11:32 .or. bynu 2420 end crys homo

stop

MINImize SD nstep 500 nprint 10 inbfrq -1 ihbfrq 0


OPEN WRITE UNIT 31 CARD NAME heat.res      ! Restart file
OPEN WRITE UNIT 32 FILE NAME heat.dcd      ! Coordinates file

DYNA STRT VERL NSTE 25000 TIME 0.001 inbfrq 10 IMGFRQ 10 -
   IPRFRQ 100 IHTFRQ 1000 IEQFRQ 0  IHBFRQ 0 NTRFRQ 100 -
   IUNREA -1 IUNWRI 31 IUNCRD 32 IUNVEL -1 -
   NPRINT 1000 ISEED 888277364 7132478 45762345 2343452 nsavc 100 -
   FIRSTT 100.0 FINALT 300.0 TEMINC 10.0 -
   TWINDH 10.0 TWINDL -10.0 -
   IASORS 1 IASVEL 1 ICHECW 0


open unit 1 write card name heat.crd
write coor card unit 1
close unit 1


open write unit 10 card name heat.pdb
write coor unit 10 pdb

cons hmcm force 1.0 refx 0.0 refy 0.0 refz 0.0 sele .not. ((segid WAT) .or. (segid CLA)) end
cons fix sele (segid CLA) end


OPEN READ  UNIT 30 CARD NAME heat.res     ! Restart file
OPEN WRITE UNIT 31 CARD NAME equi.res      ! Restart file
OPEN WRITE UNIT 32 FILE NAME equi.dcd      ! Coordinates file


DYNA RESTRT VERL NSTE 25000 TIME 0.001 inbfrq 10 IMGFRQ 10 -
   IPRFRQ 100 IEQFRQ 200  IHBFRQ 0 NTRFRQ 100 -
   IUNREA 30 IUNWRI 31 IUNCRD 32 IUNVEL -1 -
   NPRINT 1000 nsavc 100  -
   FIRSTT 300.0 FINALT 300.0 -
   TWINDH 10.0 TWINDL -10.0 -
   IASORS 1 IASVEL 1 ICHECW 0


OPEN UNIT 3 WRITE CARD NAME equi.psf
WRITE PSF CARD UNIT 3 
CLOSE UNIT 3

OPEN UNIT 1 WRITE CARD NAME equi.pdb
WRITE COOR PDB UNIT 1
CLOSE UNIT 1

OPEN UNIT 1 WRITE CARD NAME equi.crd
WRITE COOR CARD UNIT 1
CLOSE UNIT 1


stop
